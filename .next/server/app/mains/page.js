(()=>{var e={};e.id=738,e.ids=[738],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4072:e=>{"use strict";e.exports=require("rimraf")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},22057:e=>{"use strict";e.exports=require("constants")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},15369:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d}),r(42320),r(32029),r(35866);var s=r(23191),a=r(88716),l=r(37922),n=r.n(l),o=r(95231),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);r.d(t,i);let d=["",{children:["mains",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,42320)),"C:\\Users\\A\\Desktop\\excel-program\\src\\app\\mains\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,32029)),"C:\\Users\\A\\Desktop\\excel-program\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\A\\Desktop\\excel-program\\src\\app\\mains\\page.tsx"],m="/mains/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/mains/page",pathname:"/mains",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},41171:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},83631:()=>{},51709:(e,t,r)=>{Promise.resolve().then(r.bind(r,86405))},86405:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(10326),a=r(17577),l=r(25603),n=r(44542),o=r(68809),i=r.n(o),d=r(35047);let c=()=>{let e=[{min:0,max:0,percentage:100},{min:0,max:0,percentage:80},{min:0,max:0,percentage:70},{min:0,max:0,percentage:60},{min:0,max:0,percentage:50}],[t,r]=(0,a.useState)(e);(0,a.useEffect)(()=>{let t=localStorage.getItem("incomeRanges");t?(console.log(localStorage.getItem("incomeRanges")),r(JSON.parse(t))):r(e)},[]);let s=e=>{localStorage.setItem("incomeRanges",JSON.stringify(e))};return{incomeRanges:t,addIncomeRange:()=>{let e=[...t,{min:0,max:0,percentage:0}];r(e),s(e)},deleteIncomeRange:e=>{let a=t.filter((t,r)=>r!==e);r(a),s(a)},handleInputChange:(e,a,l)=>{let n=[...t],o=parseInt(l.replace(/,/g,""),10);"min"===a?n[e].min=o:"max"===a?n[e].max=o:"percentage"===a&&(n[e].percentage=o>100?100:o),r(n),s(n)}}},m=e=>isNaN(e)?"":e.toLocaleString();function p(){let[e,t]=(0,a.useState)([]),[r,o]=(0,a.useState)(0),[p,x]=(0,a.useState)(0),[u,g]=(0,a.useState)(0),[f,h]=(0,a.useState)(0),{incomeRanges:b,addIncomeRange:j,deleteIncomeRange:v,handleInputChange:C}=c(),y=(0,d.useRouter)(),w=async()=>{y.push("/login")},N=e=>{let t=0,r=0,s=e.reduce((e,s)=>{let a=s[" 지급총액 "]||0,l=100;if(s["비고"]&&s["비고"].includes("전액신고"))l=100;else if(s["비고"]&&"전액신고"!==s["비고"]||"전액 신고"!==s["비고"])return t++,e;else for(let e of b)if(a>=e.min&&a<=e.max){l=e.percentage;break}return r+=a*l/100,e+a},0);o(e=>e+s),g(Math.floor(r)),x(e=>e+t),h(e=>e+s-Math.floor(r))},F=async()=>{if(0===r)return;let e=new(i()).Workbook,t=e.addWorksheet("Summary");t.addRow(["확인필요","지급총액","수정 지급총액","수정 순이익총액"]),t.addRow([p,r.toLocaleString(),u.toLocaleString(),f.toLocaleString()]),t.columns=[{width:50},{width:50},{width:50},{width:50}],t.getCell("A1").font={name:"Arial",size:20,bold:!0},t.getCell("A1").alignment={vertical:"middle",horizontal:"center"},t.getCell("A1").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFE0B2"}},t.getCell("B1").font={name:"Arial",size:20,bold:!0},t.getCell("B1").alignment={vertical:"middle",horizontal:"center"},t.getCell("B1").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFE0B2"}},t.getCell("C1").font={name:"Arial",size:20,bold:!0},t.getCell("C1").alignment={vertical:"middle",horizontal:"center"},t.getCell("C1").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFE0B2"}},t.getCell("D1").font={name:"Arial",size:20,bold:!0},t.getCell("D1").alignment={vertical:"middle",horizontal:"center"},t.getCell("D1").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFE0B2"}},t.getCell("A2").font={name:"Arial",size:25,bold:!0,color:{argb:"FFFF0000"}},t.getCell("A2").alignment={vertical:"middle",horizontal:"center"},t.getCell("B2").font={name:"Arial",size:25,bold:!0},t.getCell("B2").alignment={vertical:"middle",horizontal:"center"},t.getCell("C2").font={name:"Arial",size:25,bold:!0,color:{argb:"FFFF0000"}},t.getCell("C2").alignment={vertical:"middle",horizontal:"center"},t.getCell("D2").font={name:"Arial",size:25,bold:!0,color:{argb:"FFFF0000"}},t.getCell("D2").alignment={vertical:"middle",horizontal:"center"},t.getRow(1).height=30,t.getRow(2).height=40;let s=new Blob([await e.xlsx.writeBuffer()],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,n.saveAs)(s,"total-sum.xlsx")};return(0,s.jsxs)("div",{className:"p-4 flex justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("button",{className:"bg-[#fff0dd] hover:bg-[#ffd29a] text-[#ffa027] border-2 border-[#ffa027] font-bold px-2 max-w-xs rounded-full focus:outline-none focus:shadow-outline",onClick:w,children:"메인 페이지"}),s.jsx("h1",{className:"font-bold m-3 text-xl",children:"엑셀 파일 업로드 데이터 조회"}),s.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:e=>{let r=e.target.files?.[0];if(!r)return;let s=new FileReader;s.onload=e=>{let r=e.target?.result,s=l.ij(r,{type:"binary"}),a=s.SheetNames[0],n=s.Sheets[a],o=l.P6.sheet_to_json(n);t(e=>[...e,...o]),N(o)},s.readAsBinaryString(r)}}),(0,s.jsxs)("table",{className:"border-separate border border-slate-400 my-4",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"border border-slate-300 p-4",children:"항목"}),s.jsx("th",{className:"border border-slate-300 p-4",children:"총합"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"border border-slate-300 p-4 ",children:"확인필요 개수"}),(0,s.jsxs)("td",{className:"border border-slate-300 p-4 text-red-500 font-semibold",children:[p," 건"]})]}),(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"border border-slate-300 p-4",children:"지급총액"}),(0,s.jsxs)("td",{className:"border border-slate-300 p-4 font-semibold",children:[r.toLocaleString()," 원"]})]}),(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"border border-slate-300 p-4",children:"수정 지급총액"}),(0,s.jsxs)("td",{className:"border border-slate-300 p-4 font-semibold",children:[u.toLocaleString()," 원"]})]}),(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"border border-slate-300 p-4",children:"수정 순이익총액"}),(0,s.jsxs)("td",{className:"border border-slate-300 p-4 font-semibold",children:[f.toLocaleString()," 원"]})]})]})]}),s.jsx("button",{onClick:F,className:"bg-[#fff0dd] hover:bg-[#ffd29a] text-[#ffa027] border-2 border-[#ffa027] font-bold py-2 px-4 w-full max-w-xs rounded-full focus:outline-none focus:shadow-outline",children:"지급총액 합산 엑셀로 저장"})]}),(0,s.jsxs)("div",{className:"relative overflow-x-auto",children:[s.jsx("h1",{className:"font-bold m-3 text-xl",children:"소득기준구간 설정"}),s.jsx("button",{className:"bg-[#fff0dd] hover:bg-[#ffd29a] text-[#ffa027] border-2 border-[#ffa027] font-bold px-2 max-w-xs rounded-full focus:outline-none focus:shadow-outline",onClick:j,children:"구간 추가"}),(0,s.jsxs)("table",{children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{children:"구간"}),s.jsx("th",{children:"최소값"}),s.jsx("th",{children:"최대값"}),s.jsx("th",{children:"백분율"})]})}),s.jsx("tbody",{children:b.map((e,t)=>(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"text-center",children:t+1}),s.jsx("td",{children:s.jsx("input",{className:"text-center",type:"text",value:m(e.min),onChange:e=>C(t,"min",e.target.value)})}),s.jsx("td",{children:s.jsx("input",{className:"text-center",type:"text",value:m(e.max),onChange:e=>C(t,"max",e.target.value)})}),s.jsx("td",{children:s.jsx("input",{className:"text-center",type:"text",value:m(e.percentage)+"%",onChange:e=>C(t,"percentage",e.target.value)})}),s.jsx("td",{children:s.jsx("button",{className:"bg-[#fff0dd] hover:bg-[#ffd29a] text-[#ffa027] border-2 border-[#ffa027] font-bold px-2 max-w-xs rounded-full focus:outline-none focus:shadow-outline",onClick:()=>v(t),children:"X"})})]},t))})]})]})]})}},32029:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>n});var s=r(19510),a=r(25384),l=r.n(a);r(5023);let n={title:"Create Next App",description:"Generated by create next app"};function o({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:l().className,children:e})})}},42320:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>o});var s=r(68570);let a=(0,s.createProxy)(String.raw`C:\Users\A\Desktop\excel-program\src\app\mains\page.tsx`),{__esModule:l,$$typeof:n}=a;a.default;let o=(0,s.createProxy)(String.raw`C:\Users\A\Desktop\excel-program\src\app\mains\page.tsx#default`)},73881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(66621);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,349,339,927],()=>r(15369));module.exports=s})();