(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[581],{67:function(){},2061:function(){},7452:function(e,t,n){Promise.resolve().then(n.bind(n,1586))},7170:function(e,t,n){var o,a,l;a=[],void 0!==(l="function"==typeof(o=function(){"use strict";function t(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){r(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,i=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,n,i){var r=l.URL||l.webkitURL,s=document.createElement("a");n=n||e.name||"download",s.download=n,s.rel="noopener","string"==typeof e?(s.href=e,s.origin===location.origin?a(s):o(s.href)?t(e,n,i):a(s,s.target="_blank")):(s.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(s.href)},4e4),setTimeout(function(){a(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,l){if(n=n||e.name||"download","string"!=typeof e){var i;navigator.msSaveOrOpenBlob((void 0===(i=l)?i={autoBom:!1}:"object"!=typeof i&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e),n)}else if(o(e))t(e,n,l);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){a(r)})}}:function(e,n,o,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,o);var r="application/octet-stream"===e.type,s=/constructor/i.test(l.HTMLElement)||l.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&s||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},d.readAsDataURL(e)}else{var u=l.URL||l.webkitURL,f=u.createObjectURL(e);a?a.location=f:location.href=f,a=null,setTimeout(function(){u.revokeObjectURL(f)},4e4)}});l.saveAs=r.saveAs=r,e.exports=r})?o.apply(t,a):o)&&(e.exports=l)},6463:function(e,t,n){"use strict";var o=n(1169);n.o(o,"useRouter")&&n.d(t,{useRouter:function(){return o.useRouter}})},1586:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var o=n(7437),a=n(2265),l=n(6463),i=n(7800),r=n(7170),s=n(1438),c=n.n(s);function d(){let e=(0,l.useRouter)(),[t,n]=(0,a.useState)(null),[s,d]=(0,a.useState)([]),[u,f]=(0,a.useState)([]),p=async()=>{e.push("/login")};return(0,o.jsx)("div",{className:"p-4 flex justify-between",children:(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{className:"bg-[#fff0dd] hover:bg-[#ffd29a] text-[#ffa027] border-2 border-[#ffa027] font-bold px-2 max-w-xs rounded-full focus:outline-none focus:shadow-outline",onClick:p,children:"메인 페이지"}),(0,o.jsx)("h1",{className:"font-bold m-3 text-xl",children:"엑셀 파일 업로드 데이터 조회"}),(0,o.jsxs)("select",{className:"bg-[#fff0dd] hover:bg-[#ffd29a] text-[#ffa027] border-2 border-[#ffa027] font-bold px-2 max-w-xs rounded-full focus:outline-none focus:shadow-outline",value:t||"",onChange:e=>{n(parseInt(e.target.value,10))},children:[(0,o.jsx)("option",{value:"",children:"월 선택"}),(0,o.jsx)("option",{value:"1",children:"1월"}),(0,o.jsx)("option",{value:"2",children:"2월"}),(0,o.jsx)("option",{value:"3",children:"3월"}),(0,o.jsx)("option",{value:"4",children:"4월"}),(0,o.jsx)("option",{value:"5",children:"5월"}),(0,o.jsx)("option",{value:"6",children:"6월"}),(0,o.jsx)("option",{value:"7",children:"7월"}),(0,o.jsx)("option",{value:"8",children:"8월"}),(0,o.jsx)("option",{value:"9",children:"9월"}),(0,o.jsx)("option",{value:"10",children:"10월"}),(0,o.jsx)("option",{value:"11",children:"11월"}),(0,o.jsx)("option",{value:"12",children:"12월"})]}),(0,o.jsx)("input",{type:"file",accept:".xlsx, .xls",multiple:!0,onChange:e=>{let t=e.target.files;t&&(d(Array.from(t)),Array.from(t).forEach(e=>{let t=new FileReader;t.onload=e=>{var t;let n=null===(t=e.target)||void 0===t?void 0:t.result,o=i.ij(n,{type:"binary"}),a=o.SheetNames[0],l=o.Sheets[a],r=i.P6.sheet_to_json(l,{header:1});f(e=>[...e,...r])},t.readAsBinaryString(e)}))}}),(0,o.jsx)("button",{className:"bg-[#ffd29a] hover:bg-[#ffa027] text-[#fff0dd] border-2 border-[#ffa027] font-bold px-2 max-w-xs rounded-full focus:outline-none focus:shadow-outline mt-4",onClick:()=>{if(null===t){alert("월을 선택해주세요.");return}let e=new(c()).Workbook,n=e.addWorksheet("업무일자"),o=["보험구분","성명","주민(외국인)등록번호","신고월\n(근로년월)","직종코드",...Array.from({length:31},(e,t)=>"".concat(t+1,"일")),"근로일수","일평균\n근로시간","보수지급\n기초일수","보수총액\n(과세소득)","임금총액","이직사유코드","보험료부과구분\n부호","보험료부과구분\n사유","국세청\n일용근로소득\n신고여부","지급월","총지급액\n(과세소득)","비과세소득","소득세","지방소득세"];n.addRow(o).eachCell(e=>{e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center",wrapText:!0},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"D3D3D3"}}}),n.columns=o.map(()=>({width:15})),n.getRow(1).height=50,n.views=[{state:"frozen",ySplit:1,xSplit:4}];let a={},l={};for(let e=0;e<u.length-1;e++){let n=u[e].find(e=>"string"==typeof e&&e.startsWith("업무일자:")),o=u[e+1][u[0].indexOf("라이더 닉네임")];if(n&&o){var i;let e=null===(i=n.split("업무일자:")[1])||void 0===i?void 0:i.trim(),r=e.slice(0,6),s=parseInt(e.slice(4,6),10),c=parseInt(e.slice(-2),10);!isNaN(s)&&s===t&&!isNaN(c)&&c>=1&&c<=31&&(a[o]||(a[o]=Array(31).fill(""),l[o]=r),a[o][c-1]=1)}}Object.keys(a).forEach(e=>{let t=l[e];n.addRow(["",e,"",t,"",...a[e]]).eachCell(e=>{e.alignment={vertical:"middle",horizontal:"center"}})}),e.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,r.saveAs)(t,"업무일자_출력.xlsx")})},children:"엑셀 생성"}),s.length>0&&(0,o.jsxs)("div",{className:"mt-4",children:[(0,o.jsx)("h2",{className:"font-bold text-lg",children:"업로드된 파일 목록:"}),(0,o.jsx)("ul",{className:"list-disc pl-5",children:s.map((e,t)=>(0,o.jsx)("li",{className:"text-sm text-gray-700",children:e.name},t))})]})]})})}}},function(e){e.O(0,[113,425,971,23,744],function(){return e(e.s=7452)}),_N_E=e.O()}]);